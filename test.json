{
    "type": "attack-pattern",
    "id": "attack-pattern--0042a9f5-f053-4769-b3ef-9ad018dfa298",
    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "created": "2020-01-14T17:18:32.126Z",
    "modified": "2020-11-10T18:29:31.004Z",
    "name": "Extra Window Memory Injection",
    "description": "Adversaries may",
    "kill_chain_phases": [{
        "kill_chain_name": "mitre-attack",
        "phase_name": "defense-evasion"
    }, {
        "kill_chain_name": "mitre-attack",
        "phase_name": "privilege-escalation"
    }],
    "external_references": [{
        "source_name": "mitre-attack",
        "url": "https://attack.mitre.org/techniques/T1055/011",
        "external_id": "T1055.011"
    }, {
        "source_name": "Microsoft Window Classes",
        "description": "Microsoft. (n.d.). About Window Classes. Retrieved December 16, 2017.",
        "url": "https://msdn.microsoft.com/library/windows/desktop/ms633574.aspx"
    }, {
        "source_name": "Microsoft GetWindowLong function",
        "description": "Microsoft. (n.d.). GetWindowLong function. Retrieved December 16, 2017.",
        "url": "https://msdn.microsoft.com/library/windows/desktop/ms633584.aspx"
    }, {
        "source_name": "Microsoft SetWindowLong function",
        "description": "Microsoft. (n.d.). SetWindowLong function. Retrieved December 16, 2017.",
        "url": "https://msdn.microsoft.com/library/windows/desktop/ms633591.aspx"
    }, {
        "source_name": "Elastic Process Injection July 2017",
        "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.",
        "url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
    }, {
        "source_name": "MalwareTech Power Loader Aug 2013",
        "description": "MalwareTech. (2013, August 13). PowerLoader Injection \u2013 Something truly amazing. Retrieved December 16, 2017.",
        "url": "https://www.malwaretech.com/2013/08/powerloader-injection-something-truly.html"
    }, {
        "source_name": "WeLiveSecurity Gapz and Redyms Mar 2013",
        "description": "Matrosov, A. (2013, March 19). Gapz and Redyms droppers based on Power Loader code. Retrieved December 16, 2017.",
        "url": "https://www.welivesecurity.com/2013/03/19/gapz-and-redyms-droppers-based-on-power-loader-code/"
    }, {
        "source_name": "Microsoft SendNotifyMessage function",
        "description": "Microsoft. (n.d.). SendNotifyMessage function. Retrieved December 16, 2017.",
        "url": "https://msdn.microsoft.com/library/windows/desktop/ms644953.aspx"
    }],
    "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"],
    "x_mitre_data_sources": ["Process: OS API Execution"],
    "x_mitre_defense_bypassed": ["Anti-virus", "Application control"],
    "x_mitre_detection": "Monitor for API calls related to enumerating and manipulating EWM such as GetWindowLong (Citation: Microsoft GetWindowLong function) and SetWindowLong (Citation: Microsoft SetWindowLong function). Malware associated with this technique have also used SendNotifyMessage (Citation: Microsoft SendNotifyMessage function) to trigger the associated window procedure and eventual malicious injection. (Citation: Elastic Process Injection July 2017)",
    "x_mitre_domains": ["enterprise-attack"],
    "x_mitre_is_subtechnique": true,
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_platforms": ["Windows"],
    "x_mitre_version": "1.0"
}


sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError)
(1048, "Column 'external_id' cannot be null")
[SQL: INSERT INTO technique (external_id, name, description, is_subtechnique) VALUES (%(external_id__0)s, %(name__0)s, %(description__0)s, %(is_subtechnique__0)s), (%(external_id__1)s, %(name__1)s, %(description__1)s, %(is_subtechnique__1)s), (%(external_i ... 50988 characters truncated ... nal_id__593)s, %(name__593)s, %(description__593)s, %(is_subtechnique__593)s) RETURNING technique.id]
[parameters: {'name__0': 'Extra Window Memory Injection', 'description__0': "Adversaries may inject malicious code into process via Extra Window Memory (EWM) in order to evade process-based defenses as well as possibly elevate ... (2048 characters truncated) ... ed privileges. Execution via EWM injection may also evade detection from security products since the execution is masked under a legitimate process. ", 'external_id__0': None, 'is_subtechnique__0': 1, 'name__1': 'Scheduled Task', 'description__1': 'Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple  ... (1846 characters truncated) ... ring the metadata (e.g., `Index` value) within associated registry keys.(Citation: Defending Against Scheduled Task Attacks in Windows Environments) ', 'external_id__1': None, 'is_subtechnique__1': 1, 'name__2': 'Socket Filters', 'description__2': 'Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated perm ... (1326 characters truncated) ... ived, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.', 'external_id__2': None, 'is_subtechnique__2': 1, 'name__3': 'Archive via Utility', 'description__3': 'Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, en ... (780 characters truncated) ... ies, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage)', 'external_id__3': None, 'is_subtechnique__3': 1, 'name__4': 'VNC', 'description__4': "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely control machines using Virtual Network Computing (VNC).   ... (1155 characters truncated) ... nerabilities)(Citation: Offensive Security VNC Authentication Check)(Citation: Attacking VNC Servers PentestLab)(Citation: Havana authentication bug)", 'external_id__4': None, 'is_subtechnique__4': 1, 'name__5': 'Windows Management Instrumentation', 'description__5': 'Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is an administration feature that prov ... (744 characters truncated) ... mation for Discovery as well as remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015)', 'external_id__5': None, 'is_subtechnique__5': 0, 'name__6': 'Screen Capture', 'description__6': 'Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality  ... (178 characters truncated) ... h as <code>CopyFromScreen</code>, <code>xwd</code>, or <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware)\n', 'external_id__6': None, 'is_subtechnique__6': 0, 'name__7': 'Boot or Logon Initialization Scripts', 'description__7': 'Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence. Initialization scripts can be used to pe ... (415 characters truncated) ... necessary. \n\nAn adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges.', 'external_id__7': None, 'is_subtechnique__7': 0, 'name__8': 'Adversary-in-the-Middle', 'description__8': 'Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support fol ... (1596 characters truncated) ... r Defenses](https://attack.mitre.org/techniques/T1562) and/or in support of a [Network Denial of Service](https://attack.mitre.org/techniques/T1498).', 'external_id__8': None, 'is_subtechnique__8': 0, 'name__9': 'System Owner/User Discovery', 'description__9': "Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is active ... (991 characters truncated) ...  enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.", 'external_id__9': None, 'is_subtechnique__9': 0, 'name__10': 'Acquire Infrastructure', 'description__10': 'Adversaries may buy, lease, or rent infrastructure that can be used during targeting. A wide variety of infrastructure exists for hosting and orchest ... (522 characters truncated) ... re that makes it difficult to physically tie back to them as well as utilize infrastructure that can be rapidly provisioned, modified, and shut down.', 'external_id__10': None, 'is_subtechnique__10': 0, 'name__11': 'Rundll32', 'description__11': 'Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly (i.e. [Shared Modules](https://a ... (2100 characters truncated) ... ing DLL file names, file extensions, or function names) to further conceal execution of a malicious payload.(Citation: rundll32.exe defense evasion) ', 'external_id__11': None, 'is_subtechnique__11': 1, 'name__12': 'Container and Resource Discovery', 'description__12': 'Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include im ... (488 characters truncated) ... sources may inform an adversaryâ€™s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution. ' ... 2276 parameters truncated ... 'external_id__581': None, 'is_subtechnique__581': 1, 'name__582': 'Network Device Authentication', 'description__582': 'Adversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to hard code a password in the operating system, thus bypassi ... (518 characters truncated) ... ted. Otherwise, the implanted code will pass the credentials on for verification of potentially valid credentials.(Citation: Mandiant - Synful Knock)', 'external_id__582': None, 'is_subtechnique__582': 1, 'name__583': 'Disk Content Wipe', 'description__583': 'Adversaries may erase the contents of storage devices on specific systems or in large numbers in a network to interrupt availability to system and ne ... (1381 characters truncated) ... /techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware)', 'external_id__583': None, 'is_subtechnique__583': 1, 'name__584': 'Exfiltration Over Unencrypted Non-C2 Protocol', 'description__584': 'Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The  ... (268 characters truncated) ...  include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields. ', 'external_id__584': None, 'is_subtechnique__584': 1, 'name__585': 'Dylib Hijacking', 'description__585': "Adversaries may execute their own payloads by placing a malicious dynamic library (dylib) with an expected name in a path a victim application search ... (1239 characters truncated) ... gitimate process.(Citation: Writing Bad Malware for OSX)(Citation: wardle artofmalware volume1)(Citation: MalwareUnicorn macOS Dylib Injection MachO)", 'external_id__585': None, 'is_subtechnique__585': 1, 'name__586': 'Downgrade System Image', 'description__586': 'Adversaries may install an older version of the operating system of a network device to weaken security.  Older operating system versions on network  ... (805 characters truncated) ... f a system image can be done on its own, or it can be used in conjunction with [Patch System Image](https://attack.mitre.org/techniques/T1601/001).  ', 'external_id__586': None, 'is_subtechnique__586': 1, 'name__587': 'Local Accounts', 'description__587': 'Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense E ... (324 characters truncated) ... ord reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement. ', 'external_id__587': None, 'is_subtechnique__587': 1, 'name__588': 'Exploitation for Defense Evasion', 'description__588': 'Adversaries may exploit a system or application vulnerability to bypass security features. Exploitation of a software vulnerability occurs when an ad ... (574 characters truncated) ... likely be targeted directly for exploitation. There are examples of antivirus software being targeted by persistent threat groups to avoid detection.', 'external_id__588': None, 'is_subtechnique__588': 0, 'name__589': 'Trusted Developer Utilities Proxy Execution', 'description__589': 'Adversaries may take advantage of trusted developer utilities to proxy execution of malicious payloads. There are many utilities used for software de ... (335 characters truncated) ...  them to execute on a system and proxy execution of malicious code through a trusted process that effectively bypasses application control solutions.', 'external_id__589': None, 'is_subtechnique__589': 0, 'name__590': 'System Shutdown/Reboot', 'description__590': 'Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands t ... (659 characters truncated) ... g/techniques/T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)', 'external_id__590': None, 'is_subtechnique__590': 0, 'name__591': 'MMC', 'description__591': 'Adversaries may abuse mmc.exe to proxy execution of malicious .msc files. Microsoft Management Console (MMC) is a binary that may be signed by Micros ... (1641 characters truncated) ... may invoke the malicious CLSID payload with the following command: <code>mmc.exe -Embedding C:\\path\\to\\test.msc</code>.(Citation: abusing_com_reg)', 'external_id__591': None, 'is_subtechnique__591': 1, 'name__592': 'Process Argument Spoofing', 'description__592': 'Adversaries may attempt to hide process command-line arguments by overwriting process memory. Process command-line arguments are stored in the proces ... (1373 characters truncated) ...  other tricks (such as [Parent PID Spoofing](https://attack.mitre.org/techniques/T1134/004)) to manipulate or further evade process-based detections.', 'external_id__592': None, 'is_subtechnique__592': 1, 'name__593': 'COR_PROFILER', 'description__593': 'Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR. The COR_PROFILER is a ... (1572 characters truncated) ... Canary COR_PROFILER May 2020)(Citation: Almond COR_PROFILER Apr 2019)(Citation: GitHub OmerYa Invisi-Shell)(Citation: subTee .NET Profilers May 2017)', 'external_id__593': None, 'is_subtechnique__593': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)